---
- name: Ensure that git packages are installed
  tags: git
  yum:
    name: "{{ item }}"
    state: present
    update_cache: yes
  register: git_yum
  with_items: "{{ git_packages }}"

- name: Clone git repositories
  tags: git
  git:
    dest: "{{ item.value.dst }}"
    force: yes
    repo: "https://{{ item.value.server }}/{{ item.value.org }}/{{ item.key }}.git"
    update: yes
  with_dict: "{{ git_repos }}"
  when:
    - item.key is defined
    - item.value.dst is defined
    - item.value.org is defined
    - item.value.server is defined
    - git_yum|success
...
